
🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀
OKX WebSocket 私有频道完整测试
🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀

================================================================================
📋 测试1: WebSocket私有频道连接与登录
================================================================================

📝 步骤1: 建立连接...
✅ WebSocket私有频道连接成功: wss://wspap.okx.com:8443/ws/v5/private
📤 已发送登录请求
✅ 登录成功！连接ID: 85fe9859
✅ 连接成功
✅ 登录成功

📝 步骤2: 断开连接...
📥 接收消息任务已取消
💓 心跳任务已取消
✅ WebSocket私有频道连接已关闭
✅ 断开成功

================================================================================
📋 测试2: 订阅订单频道
================================================================================

📝 步骤1: 建立连接...
✅ WebSocket私有频道连接成功: wss://wspap.okx.com:8443/ws/v5/private
📤 已发送登录请求
✅ 登录成功！连接ID: c1858a24

📝 步骤2: 订阅订单频道（币币）...
📤 发送订阅请求: {'channel': 'orders', 'instType': 'SPOT'}
✅ 订阅成功: {'channel': 'orders', 'instType': 'SPOT'}

📝 步骤3: 等待订单推送（30秒）...
   💡 提示：请在OKX模拟盘网页手动下单测试
   💡 建议：下一个BTC-USDT的限价单

📊 接收统计:
   收到订单事件: 0 个
   收到原始数据: 0 条

⚠️  未收到订单推送
   可能原因：
   1. 没有在模拟盘下单
   2. 下单的产品类型不是SPOT
   3. WebSocket连接有问题

📝 步骤4: 取消订阅...
📤 发送取消订阅请求: {'channel': 'orders', 'instType': 'SPOT'}
✅ 取消订阅成功: {'channel': 'orders', 'instType': 'SPOT'}

📝 步骤5: 断开连接...
📥 接收消息任务已取消
💓 心跳任务已取消
✅ WebSocket私有频道连接已关闭

================================================================================
📋 测试3: 自动下单并接收订单推送
================================================================================

📝 步骤1: 建立WebSocket连接...
✅ WebSocket私有频道连接成功: wss://wspap.okx.com:8443/ws/v5/private
📤 已发送登录请求
✅ 登录成功！连接ID: 3a84b4c7

📝 步骤2: 订阅订单频道...
📤 发送订阅请求: {'channel': 'orders', 'instType': 'SPOT'}
✅ 订阅成功: {'channel': 'orders', 'instType': 'SPOT'}

📝 步骤3: 查询当前价格...
   当前价格: 89659.1 USDT
   下单价格: 71727.28 USDT (80%当前价)

📝 步骤4: 下单...
✅ 下单成功
   订单ID: 3103865006071308288
   客户订单ID: 6079ac4d174145e4

📝 步骤5: 等待订单推送（10秒）...

📦 [1] 收到订单事件:
   订单ID: 3103865006071308288
   客户订单ID: 6079ac4d174145e4
   产品: BTC-USDT
   方向: BUY
   类型: LIMIT
   价格: 71727.2
   数量: 0.001
   已成交: 0.0
   成交均价: None
   状态: ACCEPTED
   创建时间: 1765004785558
   更新时间: 1765004785558

📊 接收统计:
   收到订单事件: 1 个

✅ 成功接收到订单推送
   订单ID: 3103865006071308288
   状态: ACCEPTED

📝 步骤6: 撤单...
✅ 撤单成功

📝 步骤7: 等待撤单推送（5秒）...

📦 [2] 收到订单事件:
   订单ID: 3103865006071308288
   客户订单ID: 6079ac4d174145e4
   产品: BTC-USDT
   方向: BUY
   类型: LIMIT
   价格: 71727.2
   数量: 0.001
   已成交: 0.0
   成交均价: None
   状态: CANCELLED
   创建时间: 1765004785558
   更新时间: 1765004796533
✅ 收到撤单推送，状态: CANCELLED

📝 步骤8: 断开连接...
📥 接收消息任务已取消
💓 心跳任务已取消
✅ WebSocket私有频道连接已关闭

================================================================================
📊 测试结果汇总
================================================================================
   连接与登录               : ✅ 通过
   订阅订单频道              : ❌ 失败
   自动下单与推送             : ✅ 通过

总计: 2/3 个测试通过
⚠️  有 1 个测试失败
