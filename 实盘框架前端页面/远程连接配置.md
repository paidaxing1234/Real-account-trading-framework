# è¿œç¨‹è¿æ¥é…ç½®æŒ‡å—

## ğŸŒ åœºæ™¯é€‰æ‹©

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | éš¾åº¦ | æˆæœ¬ |
|------|---------|------|------|
| ä¸ªäººå¼€å‘/æµ‹è¯• | ngrok/frp | â­ | å…è´¹ |
| å›¢é˜Ÿåä½œ | Tailscale VPN | â­â­ | å…è´¹ |
| æ­£å¼ç”Ÿäº§ç¯å¢ƒ | äº‘æœåŠ¡å™¨+Nginx | â­â­â­ | $$$ |
| ä¸´æ—¶æ¼”ç¤º | Cloudflare Tunnel | â­â­ | å…è´¹ |

## ğŸš€ å¿«é€Ÿæ–¹æ¡ˆï¼šngrokï¼ˆ5åˆ†é’Ÿï¼‰

### æ­¥éª¤1: ä¸‹è½½ngrok
```bash
# https://ngrok.com/download
# æ³¨å†Œå¹¶ä¸‹è½½
```

### æ­¥éª¤2: å¯åŠ¨C++åç«¯
```bash
cd cpp/examples
./ws_vue_server
```

### æ­¥éª¤3: å¯åŠ¨ngrok
```bash
ngrok tcp 8001
```

ä½ ä¼šçœ‹åˆ°ï¼š
```
Forwarding: tcp://0.tcp.ngrok.io:12345 -> localhost:8001
```

### æ­¥éª¤4: é…ç½®å‰ç«¯
```bash
# åˆ›å»º .env.development
echo "VITE_WS_URL=ws://0.tcp.ngrok.io:12345" > .env.development
```

### æ­¥éª¤5: å¯åŠ¨å‰ç«¯
```bash
npm run dev
```

âœ… ç°åœ¨ä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡ä½ çš„å‰ç«¯URLè®¿é—®ï¼

## ğŸ¢ ç”Ÿäº§æ–¹æ¡ˆï¼šäº‘æœåŠ¡å™¨

### æ¶æ„
```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Internet  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚    Nginx    â”‚
                    â”‚   (SSL/WSS) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
   â”‚  Vue    â”‚      â”‚  C++ WS     â”‚   â”‚   Database  â”‚
   â”‚ (é™æ€)  â”‚      â”‚  (8001)     â”‚   â”‚             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Nginxå®Œæ•´é…ç½®
```nginx
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    # SSLè¯ä¹¦ï¼ˆLet's Encryptå…è´¹ï¼‰
    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;
    
    # SSLé…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/trading/dist;
        try_files $uri $uri/ /index.html;
        
        # ç¼“å­˜é…ç½®
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }
    
    # WebSocket
    location /ws {
        proxy_pass http://localhost:8001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # è¶…æ—¶è®¾ç½®ï¼ˆé‡è¦ï¼ï¼‰
        proxy_connect_timeout 7d;
        proxy_send_timeout 7d;
        proxy_read_timeout 7d;
    }
    
    # APIè·¯ç”±ï¼ˆå¦‚æœæœ‰ï¼‰
    location /api {
        proxy_pass http://localhost:8002;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### ç”³è¯·å…è´¹SSLè¯ä¹¦
```bash
# ä½¿ç”¨Let's Encrypt
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. å¯ç”¨èº«ä»½éªŒè¯
```javascript
// å‰ç«¯å‘é€token
wsClient.send('auth', {
  token: localStorage.getItem('token')
})
```

```cpp
// C++åç«¯éªŒè¯
void onMessage(const std::string& msg) {
    json message = json::parse(msg);
    if (message["action"] == "auth") {
        string token = message["data"]["token"];
        if (!validateToken(token)) {
            sendError("Unauthorized");
            closeConnection();
        }
    }
}
```

### 2. IPç™½åå•
```nginx
# Nginx
location /ws {
    allow 1.2.3.4;
    allow 10.0.0.0/8;
    deny all;
    
    proxy_pass http://localhost:8001;
}
```

### 3. é˜²ç«å¢™é…ç½®
```bash
# Ubuntu/Debian
sudo ufw allow 443/tcp
sudo ufw allow 8001/tcp from 1.2.3.4
sudo ufw enable
```

## ğŸ“± è·¨å¹³å°è®¿é—®

### æ‰‹æœºè®¿é—®
1. **ç¡®ä¿åœ¨åŒä¸€WiFiä¸‹**
```javascript
// ä½¿ç”¨ç”µè„‘çš„å±€åŸŸç½‘IP
VITE_WS_URL=ws://192.168.1.100:8001
```

2. **æŸ¥çœ‹ç”µè„‘IP**
```bash
# Windows
ipconfig

# Linux/Mac
ifconfig
```

3. **æ‰‹æœºæµè§ˆå™¨è®¿é—®**
```
http://192.168.1.100:3000
```

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: WebSocketè¿æ¥è¢«æ‹’ç»
```bash
# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tuln | grep 8001

# æ£€æŸ¥C++åç«¯æ—¥å¿—
tail -f ws_server.log
```

### é—®é¢˜2: SSL/WSSè¯ä¹¦é—®é¢˜
```bash
# æµ‹è¯•SSLè¯ä¹¦
openssl s_client -connect your-domain.com:443

# æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸ
sudo certbot certificates
```

### é—®é¢˜3: Nginxé…ç½®é”™è¯¯
```bash
# æµ‹è¯•é…ç½®
sudo nginx -t

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å¼€å‘ç¯å¢ƒ**: localhost
2. **å›¢é˜Ÿåä½œ**: Tailscale VPN
3. **ä¸´æ—¶æ¼”ç¤º**: ngrok/frp
4. **ç”Ÿäº§éƒ¨ç½²**: äº‘æœåŠ¡å™¨+Nginx+SSL

---

**é€‰æ‹©å»ºè®®ï¼š**
- ğŸ¯ **åˆšå¼€å§‹ï¼Ÿ** â†’ ç”¨ ngrokï¼Œæœ€ç®€å•
- ğŸ¯ **å›¢é˜Ÿå¼€å‘ï¼Ÿ** â†’ ç”¨ Tailscale VPN
- ğŸ¯ **æ­£å¼ä¸Šçº¿ï¼Ÿ** â†’ ç§Ÿäº‘æœåŠ¡å™¨ + é…ç½®Nginx

