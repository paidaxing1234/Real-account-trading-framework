# ğŸš€ å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## ğŸ“¦ æ–°å¢æ–‡ä»¶è¯´æ˜

### ClickHouseæ•°æ®åº“
```
database/
â””â”€â”€ clickhouse_schema.sql    # ClickHouseæ•°æ®è¡¨è®¾è®¡
```

### éƒ¨ç½²è„šæœ¬
```
deploy/
â”œâ”€â”€ nginx.conf               # Nginxé…ç½®æ–‡ä»¶
â”œâ”€â”€ deploy.sh                # è‡ªåŠ¨éƒ¨ç½²è„šæœ¬
â””â”€â”€ setup-ssl.sh            # SSLè¯ä¹¦é…ç½®è„šæœ¬
```

### æ–‡æ¡£
```
éƒ¨ç½²æŒ‡å—.md                  # å®Œæ•´çš„Linuxéƒ¨ç½²æ•™ç¨‹
é•¿æœŸè¿è¡Œå»ºè®®.md              # ç³»ç»Ÿè¿è¡Œå»ºè®®
```

## âš¡ 5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²

### æ­¥éª¤1ï¼šæœ¬åœ°æ„å»º
```bash
npm run build
```

### æ­¥éª¤2ï¼šä¸Šä¼ åˆ°æœåŠ¡å™¨
```bash
# æ–¹å¼1ï¼šä½¿ç”¨SCP
scp -r dist deploy database root@ä½ çš„æœåŠ¡å™¨IP:/tmp/trading-system/

# æ–¹å¼2ï¼šä½¿ç”¨rsyncï¼ˆæ¨èï¼‰
rsync -avz dist deploy database root@ä½ çš„æœåŠ¡å™¨IP:/tmp/trading-system/
```

### æ­¥éª¤3ï¼šæœåŠ¡å™¨ç«¯éƒ¨ç½²
```bash
# SSHè¿æ¥åˆ°æœåŠ¡å™¨
ssh root@ä½ çš„æœåŠ¡å™¨IP

# è¿›å…¥ç›®å½•
cd /tmp/trading-system

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x deploy/*.sh

# æ‰§è¡Œéƒ¨ç½²
./deploy/deploy.sh
```

### æ­¥éª¤4ï¼šé…ç½®SSLï¼ˆå¯é€‰ï¼‰
```bash
./deploy/setup-ssl.sh
```

## ğŸ—„ï¸ ClickHouseæ•°æ®åº“

### ä¸ºä»€ä¹ˆä½¿ç”¨ClickHouseï¼Ÿ

**ClickHouseæ˜¯é‡åŒ–äº¤æ˜“çš„å®Œç¾é€‰æ‹©ï¼š**

âœ… **æé€ŸæŸ¥è¯¢** - å¤„ç†ç™¾äº¿çº§æ•°æ®ç§’çº§å“åº”  
âœ… **æ—¶åºä¼˜åŒ–** - å¤©ç”Ÿé€‚åˆKçº¿ã€è¡Œæƒ…ç­‰æ—¶åºæ•°æ®  
âœ… **å®æ—¶ç»Ÿè®¡** - ç‰©åŒ–è§†å›¾æ”¯æŒå®æ—¶èšåˆ  
âœ… **å­˜å‚¨é«˜æ•ˆ** - å‹ç¼©æ¯”å¯è¾¾10:1  
âœ… **SQLæ ‡å‡†** - æ˜“äºä½¿ç”¨å’Œç»´æŠ¤  

### å¿«é€Ÿå®‰è£…

```bash
# Ubuntu/Debian
sudo apt-get install -y clickhouse-server clickhouse-client
sudo systemctl start clickhouse-server

# åˆå§‹åŒ–æ•°æ®åº“
clickhouse-client --multiquery < database/clickhouse_schema.sql
```

### æ•°æ®è¡¨è®¾è®¡

å·²åˆ›å»ºä»¥ä¸‹è¡¨ï¼š
- âœ… **users** - ç”¨æˆ·è¡¨
- âœ… **strategies** - ç­–ç•¥è¡¨
- âœ… **accounts** - è´¦æˆ·è¡¨
- âœ… **account_snapshots** - è´¦æˆ·å¿«ç…§ï¼ˆæ—¶åºï¼‰
- âœ… **orders** - è®¢å•è¡¨
- âœ… **trades** - æˆäº¤è®°å½•
- âœ… **positions** - æŒä»“è¡¨
- âœ… **strategy_performance** - ç­–ç•¥æ€§èƒ½ï¼ˆæ—¶åºï¼‰
- âœ… **system_logs** - ç³»ç»Ÿæ—¥å¿—

è¿˜åŒ…å«3ä¸ªç‰©åŒ–è§†å›¾ç”¨äºå®æ—¶ç»Ÿè®¡ï¼

## ğŸ“Š æ¶æ„è¯´æ˜

### å®Œæ•´æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ (Vue 3)        â”‚
â”‚  Nginxåå‘ä»£ç†        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ HTTPS/WSS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯API             â”‚
â”‚  (Python/FastAPI)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redis â”‚    â”‚ ClickHouseâ”‚
â”‚ ç¼“å­˜   â”‚    â”‚ æ—¶åºæ•°æ®   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®å­˜å‚¨ç­–ç•¥

| æ•°æ®ç±»å‹ | å­˜å‚¨æ–¹æ¡ˆ | åŸå›  |
|---------|---------|------|
| ç”¨æˆ·ä¼šè¯ | Redis | å¿«é€Ÿè¯»å†™ |
| å®æ—¶è¡Œæƒ… | Redis | é«˜é¢‘æ›´æ–° |
| å†å²è®¢å• | ClickHouse | å¤§é‡æ•°æ®åˆ†æ |
| å‡€å€¼æ›²çº¿ | ClickHouse | æ—¶åºæŸ¥è¯¢ä¼˜åŒ– |
| ç­–ç•¥æ€§èƒ½ | ClickHouse | èšåˆè®¡ç®— |

## ğŸ”§ é…ç½®è¯´æ˜

### 1. Nginxé…ç½®

ç¼–è¾‘ `deploy/nginx.conf`ï¼š

```nginx
# ä¿®æ”¹åŸŸå
server_name your-domain.com;

# ä¿®æ”¹åç«¯åœ°å€
upstream trading_backend {
    server 127.0.0.1:8000;  # æ”¹ä¸ºä½ çš„åç«¯åœ°å€
}
```

### 2. ç¯å¢ƒå˜é‡

åˆ›å»º `.env.production`:

```bash
# åç«¯APIåœ°å€
VITE_API_BASE_URL=https://your-domain.com

# ClickHouseè¿æ¥
CLICKHOUSE_HOST=localhost
CLICKHOUSE_PORT=8123
CLICKHOUSE_DATABASE=trading_system
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=your-password
```

## ğŸ“ éƒ¨ç½²æ¸…å•

### å‰ææ¡ä»¶
- [ ] LinuxæœåŠ¡å™¨ï¼ˆUbuntu 20.04+ï¼‰
- [ ] åŸŸåï¼ˆå¯é€‰ï¼Œå¯ç”¨IPè®¿é—®ï¼‰
- [ ] 2æ ¸4Gå†…å­˜ä»¥ä¸Š
- [ ] å…¬ç½‘IP

### å®‰è£…æ¸…å•
- [ ] Nginx
- [ ] ClickHouse Server
- [ ] Redisï¼ˆæ¨èï¼‰
- [ ] Python 3.8+ï¼ˆåç«¯ï¼‰
- [ ] SSLè¯ä¹¦ï¼ˆæ¨èï¼‰

### éƒ¨ç½²æ¸…å•
- [ ] å‰ç«¯æ„å»ºå¹¶ä¸Šä¼ 
- [ ] é…ç½®Nginx
- [ ] åˆå§‹åŒ–ClickHouse
- [ ] é…ç½®SSL
- [ ] å¯åŠ¨åç«¯æœåŠ¡
- [ ] æµ‹è¯•è®¿é—®

## ğŸ¯ åç«¯å¼€å‘å»ºè®®

### APIæ¥å£ä¼˜å…ˆçº§

#### ç¬¬ä¸€é˜¶æ®µï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰
1. âœ… ç”¨æˆ·è®¤è¯ï¼ˆç™»å½•/ç™»å‡ºï¼‰
2. âœ… ç­–ç•¥CRUDæ¥å£
3. âœ… è´¦æˆ·æŸ¥è¯¢æ¥å£
4. âœ… è®¢å•æŸ¥è¯¢æ¥å£

#### ç¬¬äºŒé˜¶æ®µï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
5. âœ… ä¸‹å•æ¥å£
6. âœ… æŒä»“æŸ¥è¯¢
7. âœ… å‡€å€¼æ›²çº¿æŸ¥è¯¢
8. âœ… å®æ—¶è¡Œæƒ…æ¥å£

#### ç¬¬ä¸‰é˜¶æ®µï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
9. âœ… WebSocketæ¨é€
10. âœ… ç­–ç•¥æ‰§è¡Œå¼•æ“å¯¹æ¥
11. âœ… æ•°æ®ç»Ÿè®¡åˆ†æ
12. âœ… æ—¥å¿—å’Œç›‘æ§

### ClickHouseæŸ¥è¯¢ç¤ºä¾‹

åç«¯APIå¯ä»¥è¿™æ ·æŸ¥è¯¢ï¼š

```python
from clickhouse_driver import Client

# è¿æ¥ClickHouse
client = Client(
    host='localhost',
    port=9000,
    database='trading_system'
)

# æŸ¥è¯¢è´¦æˆ·å‡€å€¼æ›²çº¿
def get_equity_curve(account_id, days=30):
    query = """
    SELECT 
        timestamp,
        equity,
        unrealized_pnl
    FROM account_snapshots
    WHERE account_id = %(account_id)s
      AND timestamp >= now() - INTERVAL %(days)s DAY
    ORDER BY timestamp
    """
    return client.execute(query, {
        'account_id': account_id,
        'days': days
    })

# æŸ¥è¯¢ç­–ç•¥æ€§èƒ½
def get_strategy_performance(strategy_id):
    query = """
    SELECT 
        sum(pnl) as total_pnl,
        avg(return_rate) as avg_return,
        sum(trades_count) as total_trades
    FROM strategy_performance
    WHERE strategy_id = %(strategy_id)s
      AND date >= today() - 30
    """
    return client.execute(query, {
        'strategy_id': strategy_id
    })
```

## ğŸ“ å¸¸è§é—®é¢˜

### Q1: ClickHouseå’ŒMySQL/PostgreSQLæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
**A**: ClickHouseæ˜¯åˆ—å¼å­˜å‚¨æ•°æ®åº“ï¼Œä¸“ä¸ºOLAPï¼ˆåˆ†æï¼‰åœºæ™¯è®¾è®¡ï¼ŒæŸ¥è¯¢é€Ÿåº¦æ¯”ä¼ ç»Ÿè¡Œå¼æ•°æ®åº“å¿«10-100å€ï¼Œä½†ä¸é€‚åˆé¢‘ç¹æ›´æ–°ã€‚

### Q2: éœ€è¦åŒæ—¶ç”¨MySQLå—ï¼Ÿ
**A**: å¦‚æœæœ‰é«˜é¢‘æ›´æ–°çš„éœ€æ±‚ï¼ˆå¦‚ç”¨æˆ·è®¾ç½®ï¼‰ï¼Œå»ºè®®é…åˆRedisæˆ–SQLiteã€‚ClickHouseä¸»è¦ç”¨äºå†å²æ•°æ®åˆ†æã€‚

### Q3: æ•°æ®é‡å¤šå¤§æ—¶ClickHouseæ‰æœ‰ä¼˜åŠ¿ï¼Ÿ
**A**: å³ä½¿å°æ•°æ®é‡ï¼ˆå‡ åä¸‡è¡Œï¼‰ClickHouseä¹Ÿèƒ½å±•ç°ä¼˜åŠ¿ã€‚å½“æ•°æ®é‡è¾¾åˆ°åƒä¸‡ã€äº¿çº§æ—¶ï¼Œä¼˜åŠ¿æ›´æ˜æ˜¾ã€‚

### Q4: å‰ç«¯éƒ¨ç½²åœ¨å“ªé‡Œï¼Ÿ
**A**: å‰ç«¯é™æ€æ–‡ä»¶é€šè¿‡Nginxéƒ¨ç½²åœ¨LinuxæœåŠ¡å™¨çš„ `/var/www/trading-system/dist`

### Q5: æ”¯æŒDockeréƒ¨ç½²å—ï¼Ÿ
**A**: æ”¯æŒï¼å¯ä»¥åˆ›å»ºDockeré•œåƒï¼Œè¯¦è§ `docker-compose.yml`ï¼ˆéœ€è¦å•ç‹¬åˆ›å»ºï¼‰

## ğŸš€ ä¸‹ä¸€æ­¥

1. **é˜…è¯»å®Œæ•´æ–‡æ¡£**: `éƒ¨ç½²æŒ‡å—.md`
2. **é…ç½®ClickHouse**: å‚è€ƒæ•°æ®åº“è®¾è®¡æ–‡ä»¶
3. **å¼€å‘åç«¯API**: è¿æ¥ClickHouseå’Œå‰ç«¯
4. **æ·»åŠ WebSocket**: å®ç°å®æ—¶æ•°æ®æ¨é€
5. **æ€§èƒ½ä¼˜åŒ–**: é…ç½®ç¼“å­˜å’ŒCDN

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [éƒ¨ç½²æŒ‡å—.md](./éƒ¨ç½²æŒ‡å—.md) - å®Œæ•´éƒ¨ç½²æ•™ç¨‹
- [é•¿æœŸè¿è¡Œå»ºè®®.md](./é•¿æœŸè¿è¡Œå»ºè®®.md) - è¿è¡Œå»ºè®®å’Œæ¶æ„è¯´æ˜
- [æƒé™ç³»ç»Ÿè¯´æ˜.md](./æƒé™ç³»ç»Ÿè¯´æ˜.md) - ç”¨æˆ·æƒé™ç®¡ç†
- [å¼€å‘æŒ‡å—.md](./å¼€å‘æŒ‡å—.md) - å¼€å‘æ–‡æ¡£

---

**ç³»ç»Ÿç‰ˆæœ¬**: v1.3.0ï¼ˆæ”¯æŒç”Ÿäº§éƒ¨ç½²ï¼‰  
**æ›´æ–°æ—¶é—´**: 2024å¹´12æœˆ8æ—¥  
**æŠ€æœ¯æ ˆ**: Vue 3 + ClickHouse + Nginx

